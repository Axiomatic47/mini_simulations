# Implementation Guide: Interactive Multi-Civilization Dashboard

This guide explains how to implement the interactive visualization dashboard for your multi-civilization simulations.

## Overview

The dashboard provides an interactive way to explore and analyze the results of your multi-civilization simulations. It visualizes:

1. **Overview Metrics**: Civilization count, knowledge and suppression levels, event distribution, and civilization positions
2. **Civilization Details**: Knowledge ranges, suppression ranges, intelligence and truth growth, and resource trends
3. **Event Analysis**: Event types, timeline, and distribution over time
4. **Stability Metrics**: Stability issues, adaptive timestep behavior, and other numerical stability indicators

## Implementation Steps

### 1. Set Up Directory Structure

```bash
mkdir -p outputs/dashboard
```

### 2. Save the React Component

Save the React dashboard component to `outputs/dashboard/dashboard-component.js`:

```bash
# Copy the full code from the React artifact
cp multi-civ-dashboard.js outputs/dashboard/dashboard-component.js
```

### 3. Create the Integration Script

Save the integration script to `simulations/multi_civilization_dashboard.py`:

```bash
# Copy the full code from the integration artifact
cp integration-code.py simulations/multi_civilization_dashboard.py
chmod +x simulations/multi_civilization_dashboard.py
```

### 4. Install Required Dependencies

```bash
pip install flask flask-cors
```

### 5. Launch the Dashboard

```bash
# Run the dashboard with existing simulation data
python simulations/multi_civilization_dashboard.py

# Or auto-run a new simulation if no data is found
python simulations/multi_civilization_dashboard.py --auto-run

# Specify a custom port
python simulations/multi_civilization_dashboard.py --port 8080
```

## Technical Details

### Dashboard Architecture

The dashboard uses:

1. **Frontend**: React with Recharts for visualization
2. **Backend**: Flask API that serves:
   - Simulation statistics data
   - Event data
   - Stability metrics

### Data Flow

1. The backend reads CSV files generated by your multi-civilization simulation:
   - `multi_civilization_statistics.csv`
   - `multi_civilization_events.csv`
   - `multi_civilization_stability.csv`

2. The API converts these to JSON and serves them to the frontend

3. The React component visualizes the data using interactive charts

### Dashboard Views

The dashboard offers four main views:

1. **Overview**: High-level metrics and civilization positioning
2. **Civilizations**: Detailed trends of civilization metrics
3. **Events**: Analysis of events and their distribution
4. **Stability**: Numerical stability metrics and adaptive timestep behavior

### Integration with Existing Code

The dashboard integrates with your existing simulation code by:

1. Reading the output files your simulation already generates
2. Not requiring changes to your core simulation code
3. Providing the option to trigger a new simulation if needed

## Customization

### Adjusting Chart Colors

```javascript
// In the dashboard component, modify the colorMap:
const colorMap = {
  'knowledge': '#8bc34a',  // Light green instead of standard green
  'suppression': '#e57373', // Lighter red
  // ...other colors
};
```

### Adding New Charts

```javascript
// In any of the render functions, add a new chart:
<div className="bg-white p-4 rounded shadow">
  <h3 className="text-lg font-semibold mb-3">New Metric</h3>
  <ResponsiveContainer width="100%" height={250}>
    <LineChart data={simulationData}>
      <CartesianGrid strokeDasharray="3 3" />
      <XAxis dataKey="time" />
      <YAxis />
      <Tooltip />
      <Line 
        type="monotone" 
        dataKey="your_new_metric" 
        stroke="#795548" 
        strokeWidth={2}
        dot={false}
      />
    </LineChart>
  </ResponsiveContainer>
</div>
```

### Adding New Metrics

If you add new metrics to your simulation, update the data preparation functions in the integration script:

```python
def prepare_simulation_data(data_file=None):
    # ...existing code...
    
    # Add any transformations for new metrics
    for record in data:
        if 'your_new_metric' in record:
            # Process the metric if needed
            record['your_new_metric_processed'] = record['your_new_metric'] * 2
    
    return data
```

## Troubleshooting

### Dashboard Shows No Data

1. Check that your simulation output files exist:
   ```bash
   ls -la outputs/data/*.csv
   ```

2. Verify that the format matches what the dashboard expects:
   ```bash
   head -n 5 outputs/data/multi_civilization_statistics.csv
   ```

3. Try running with the auto-run flag:
   ```bash
   python simulations/multi_civilization_dashboard.py --auto-run
   ```

### Dashboard Doesn't Start

1. Check Flask is installed:
   ```bash
   pip show flask flask-cors
   ```

2. Verify permissions on the script:
   ```bash
   chmod +x simulations/multi_civilization_dashboard.py
   ```

3. Check if another service is using the port:
   ```bash
   lsof -i :5000
   # Try a different port if needed
   python simulations/multi_civilization_dashboard.py --port 8080
   ```

## Next Steps

1. **Data Export**: Add options to export chart data or specific visualizations
2. **Parameter Controls**: Add UI elements to adjust simulation parameters and run new simulations
3. **Real-time Updates**: Modify the dashboard to update in real-time during simulation runs
4. **Comparative Analysis**: Enable side-by-side comparison of multiple simulation runs